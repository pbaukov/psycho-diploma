<div class="container">
  <header class="header">
    <h1>–ü—Å–∏—Ö–æ–¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h1>
    <p class="subtitle">–ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –¥–æ/–ø—ñ—Å–ª—è</p>
  </header>

  <main class="main-content">
    <!-- Upload Zones Container - Show until both files are uploaded -->
    <div class="upload-zones-container" *ngIf="!hasBeforeData || !hasAfterData">
      <!-- BEFORE Upload Zone -->
      <div class="upload-zone-wrapper">
        <div class="upload-zone-label before-label">
          <span class="label-icon">üìã</span>
          <span class="label-text">–î–û (Before)</span>
        </div>
        <div
          class="upload-zone"
          [class.dragging]="isDraggingBefore"
          [class.has-data]="hasBeforeData"
          (dragover)="onDragOver($event, 'before')"
          (dragleave)="onDragLeave($event, 'before')"
          (drop)="onDrop($event, 'before')">
          <div
            class="upload-content"
            *ngIf="!isLoadingBefore && !hasBeforeData">
            <div class="upload-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="40"
                height="40"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="17 8 12 3 7 8" />
                <line x1="12" y1="3" x2="12" y2="15" />
              </svg>
            </div>
            <p class="upload-text">–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å CSV —Ñ–∞–π–ª</p>
            <span class="upload-divider">–∞–±–æ</span>
            <label class="upload-button">
              –û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª
              <input
                type="file"
                accept=".csv"
                (change)="onFileSelected($event, 'before')"
                hidden />
            </label>
          </div>
          <div class="upload-success" *ngIf="hasBeforeData && !isLoadingBefore">
            <div class="success-icon">‚úì</div>
            <p class="success-filename">{{ beforeFileName }}</p>
            <p class="success-count">
              {{ beforeRespondents.length }} —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤
            </p>
            <button class="clear-file-btn" (click)="clearData('before')">
              –ó–º—ñ–Ω–∏—Ç–∏ —Ñ–∞–π–ª
            </button>
          </div>
          <div class="loading-content" *ngIf="isLoadingBefore">
            <div class="spinner"></div>
            <p>–û–±—Ä–æ–±–∫–∞ —Ñ–∞–π–ª—É...</p>
          </div>
        </div>
        <div class="error-message" *ngIf="errorMessageBefore">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <circle cx="12" cy="12" r="10" />
            <line x1="12" y1="8" x2="12" y2="12" />
            <line x1="12" y1="16" x2="12.01" y2="16" />
          </svg>
          {{ errorMessageBefore }}
        </div>
      </div>

      <!-- AFTER Upload Zone -->
      <div class="upload-zone-wrapper">
        <div class="upload-zone-label after-label">
          <span class="label-icon">üìä</span>
          <span class="label-text">–ü–Ü–°–õ–Ø (After)</span>
        </div>
        <div
          class="upload-zone"
          [class.dragging]="isDraggingAfter"
          [class.has-data]="hasAfterData"
          (dragover)="onDragOver($event, 'after')"
          (dragleave)="onDragLeave($event, 'after')"
          (drop)="onDrop($event, 'after')">
          <div class="upload-content" *ngIf="!isLoadingAfter && !hasAfterData">
            <div class="upload-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="40"
                height="40"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="17 8 12 3 7 8" />
                <line x1="12" y1="3" x2="12" y2="15" />
              </svg>
            </div>
            <p class="upload-text">–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å CSV —Ñ–∞–π–ª</p>
            <span class="upload-divider">–∞–±–æ</span>
            <label class="upload-button">
              –û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª
              <input
                type="file"
                accept=".csv"
                (change)="onFileSelected($event, 'after')"
                hidden />
            </label>
          </div>
          <div class="upload-success" *ngIf="hasAfterData && !isLoadingAfter">
            <div class="success-icon">‚úì</div>
            <p class="success-filename">{{ afterFileName }}</p>
            <p class="success-count">
              {{ afterRespondents.length }} —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤
            </p>
            <button class="clear-file-btn" (click)="clearData('after')">
              –ó–º—ñ–Ω–∏—Ç–∏ —Ñ–∞–π–ª
            </button>
          </div>
          <div class="loading-content" *ngIf="isLoadingAfter">
            <div class="spinner"></div>
            <p>–û–±—Ä–æ–±–∫–∞ —Ñ–∞–π–ª—É...</p>
          </div>
        </div>
        <div class="error-message" *ngIf="errorMessageAfter">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <circle cx="12" cy="12" r="10" />
            <line x1="12" y1="8" x2="12" y2="12" />
            <line x1="12" y1="16" x2="12.01" y2="16" />
          </svg>
          {{ errorMessageAfter }}
        </div>
      </div>
    </div>

    <!-- Hint when only one file is uploaded -->
    <div
      class="continue-section"
      *ngIf="hasAnyData && (!hasBeforeData || !hasAfterData)">
      <p class="continue-hint">
        –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –æ–±–∏–¥–≤–∞ —Ñ–∞–π–ª–∏ –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
      </p>
    </div>

    <!-- Results Section -->
    <div class="results-section" *ngIf="hasAnyData">
      <!-- Dataset Toggle -->
      <div class="dataset-toggle">
        <button
          class="dataset-btn before-btn"
          [class.active]="activeDataset === 'before'"
          [class.has-data]="hasBeforeData"
          [disabled]="!hasBeforeData"
          (click)="setActiveDataset('before')">
          <span class="dataset-icon">üìã</span>
          <span class="dataset-label">–î–û</span>
          <span class="dataset-filename" *ngIf="hasBeforeData">{{
            beforeFileName
          }}</span>
          <span class="dataset-count" *ngIf="hasBeforeData">{{
            beforeRespondents.length
          }}</span>
          <span class="no-data-hint" *ngIf="!hasBeforeData"
            >–ù–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ</span
          >
        </button>
        <button
          class="dataset-btn after-btn"
          [class.active]="activeDataset === 'after'"
          [class.has-data]="hasAfterData"
          [disabled]="!hasAfterData"
          (click)="setActiveDataset('after')">
          <span class="dataset-icon">üìä</span>
          <span class="dataset-label">–ü–Ü–°–õ–Ø</span>
          <span class="dataset-filename" *ngIf="hasAfterData">{{
            afterFileName
          }}</span>
          <span class="dataset-count" *ngIf="hasAfterData">{{
            afterRespondents.length
          }}</span>
          <span class="no-data-hint" *ngIf="!hasAfterData">–ù–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ</span>
        </button>
      </div>

      <!-- Export Button - Only when both files are uploaded -->
      <div class="export-section" *ngIf="hasBothData">
        <button class="export-button" (click)="exportToCSV()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
            <polyline points="7 10 12 15 17 10" />
            <line x1="12" y1="15" x2="12" y2="3" />
          </svg>
          –ï–∫—Å–ø–æ—Ä—Ç –¥–ª—è SPSS (CSV)
        </button>
        <span class="export-hint"
          >–û–±'—î–¥–Ω–∞–Ω—ñ –¥–∞–Ω—ñ "–¥–æ" —Ç–∞ "–ø—ñ—Å–ª—è" –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É</span
        >
      </div>

      <!-- Header with file info -->
      <div class="results-header">
        <div class="file-info">
          <span class="current-dataset-badge" [class]="activeDataset">
            {{ activeDataset === 'before' ? '–î–û' : '–ü–Ü–°–õ–Ø' }}
          </span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <path
              d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
            <polyline points="14 2 14 8 20 8" />
            <line x1="16" y1="13" x2="8" y2="13" />
            <line x1="16" y1="17" x2="8" y2="17" />
            <polyline points="10 9 9 9 8 9" />
          </svg>
          <span class="file-name">{{ fileName }}</span>
          <span class="respondent-count"
            >{{ respondents.length }} —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤</span
          >
        </div>
        <button class="clear-button" (click)="clearData()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
          –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ
        </button>
      </div>

      <!-- Tabs -->
      <div class="tabs">
        <button
          class="tab"
          [class.active]="activeTab === 'san'"
          (click)="setActiveTab('san')">
          <span class="tab-icon">üìä</span>
          –°–ê–ù
        </button>
        <button
          class="tab"
          [class.active]="activeTab === 'shtepa'"
          (click)="setActiveTab('shtepa')">
          <span class="tab-icon">üß†</span>
          –®—Ç–µ–ø–∞
        </button>
        <button
          class="tab"
          [class.active]="activeTab === 'basicph'"
          (click)="setActiveTab('basicph')">
          <span class="tab-icon">üí™</span>
          Basic Ph
        </button>
        <button
          class="tab"
          [class.active]="activeTab === 'personalresource'"
          (click)="setActiveTab('personalresource')">
          <span class="tab-icon">‚ú®</span>
          –û—Å–æ–±. —Ä–µ—Å—É—Ä—Å–∏
        </button>
        <button
          class="tab"
          [class.active]="activeTab === 'ryff'"
          (click)="setActiveTab('ryff')">
          <span class="tab-icon">üåü</span>
          Ryff
        </button>
      </div>

      <!-- –°–ê–ù Tab Content -->
      <div class="tab-content" *ngIf="activeTab === 'san'">
        <!-- Overall Statistics -->
        <div class="overall-stats">
          <h2>–ó–∞–≥–∞–ª—å–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –°–ê–ù</h2>
          <div class="stats-grid">
            <div class="stat-card wellbeing">
              <div class="stat-label">–°–∞–º–æ–ø–æ—á—É—Ç—Ç—è</div>
              <div
                class="stat-value"
                [class]="getSanScaleClass(overallWellbeing)">
                {{ overallWellbeing }}
              </div>
              <div class="stat-bar">
                <div
                  class="stat-bar-fill"
                  [style.width.%]="(overallWellbeing / 7) * 100"></div>
              </div>
            </div>
            <div class="stat-card activity">
              <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</div>
              <div
                class="stat-value"
                [class]="getSanScaleClass(overallActivity)">
                {{ overallActivity }}
              </div>
              <div class="stat-bar">
                <div
                  class="stat-bar-fill"
                  [style.width.%]="(overallActivity / 7) * 100"></div>
              </div>
            </div>
            <div class="stat-card mood">
              <div class="stat-label">–ù–∞—Å—Ç—Ä—ñ–π</div>
              <div class="stat-value" [class]="getSanScaleClass(overallMood)">
                {{ overallMood }}
              </div>
              <div class="stat-bar">
                <div
                  class="stat-bar-fill"
                  [style.width.%]="(overallMood / 7) * 100"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Group-Specific Statistics -->
        <div
          class="overall-stats group-stats"
          *ngIf="getGroupCount('1') > 0 || getGroupCount('2') > 0">
          <h2>–ü–æ–∫–∞–∑–Ω–∏–∫–∏ –°–ê–ù –∑–∞ –≥—Ä—É–ø–∞–º–∏</h2>
          <div class="group-comparison">
            <!-- Group 1 -->
            <div class="group-section" *ngIf="getGroupCount('1') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 1 (n={{ getGroupCount('1') }})</h3>
              <div class="stats-grid">
                <div class="stat-card wellbeing">
                  <div class="stat-label">–°–∞–º–æ–ø–æ—á—É—Ç—Ç—è</div>
                  <div
                    class="stat-value"
                    [class]="getSanScaleClass(getGroupWellbeing('1'))">
                    {{ getGroupWellbeing('1') }}
                  </div>
                  <div class="stat-bar">
                    <div
                      class="stat-bar-fill"
                      [style.width.%]="
                        (getGroupWellbeing('1') / 7) * 100
                      "></div>
                  </div>
                </div>
                <div class="stat-card activity">
                  <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</div>
                  <div
                    class="stat-value"
                    [class]="getSanScaleClass(getGroupActivity('1'))">
                    {{ getGroupActivity('1') }}
                  </div>
                  <div class="stat-bar">
                    <div
                      class="stat-bar-fill"
                      [style.width.%]="(getGroupActivity('1') / 7) * 100"></div>
                  </div>
                </div>
                <div class="stat-card mood">
                  <div class="stat-label">–ù–∞—Å—Ç—Ä—ñ–π</div>
                  <div
                    class="stat-value"
                    [class]="getSanScaleClass(getGroupMood('1'))">
                    {{ getGroupMood('1') }}
                  </div>
                  <div class="stat-bar">
                    <div
                      class="stat-bar-fill"
                      [style.width.%]="(getGroupMood('1') / 7) * 100"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group 2 -->
            <div class="group-section" *ngIf="getGroupCount('2') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 2 (n={{ getGroupCount('2') }})</h3>
              <div class="stats-grid">
                <div class="stat-card wellbeing">
                  <div class="stat-label">–°–∞–º–æ–ø–æ—á—É—Ç—Ç—è</div>
                  <div
                    class="stat-value"
                    [class]="getSanScaleClass(getGroupWellbeing('2'))">
                    {{ getGroupWellbeing('2') }}
                  </div>
                  <div class="stat-bar">
                    <div
                      class="stat-bar-fill"
                      [style.width.%]="
                        (getGroupWellbeing('2') / 7) * 100
                      "></div>
                  </div>
                </div>
                <div class="stat-card activity">
                  <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</div>
                  <div
                    class="stat-value"
                    [class]="getSanScaleClass(getGroupActivity('2'))">
                    {{ getGroupActivity('2') }}
                  </div>
                  <div class="stat-bar">
                    <div
                      class="stat-bar-fill"
                      [style.width.%]="(getGroupActivity('2') / 7) * 100"></div>
                  </div>
                </div>
                <div class="stat-card mood">
                  <div class="stat-label">–ù–∞—Å—Ç—Ä—ñ–π</div>
                  <div
                    class="stat-value"
                    [class]="getSanScaleClass(getGroupMood('2'))">
                    {{ getGroupMood('2') }}
                  </div>
                  <div class="stat-bar">
                    <div
                      class="stat-bar-fill"
                      [style.width.%]="(getGroupMood('2') / 7) * 100"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Individual –°–ê–ù Results -->
        <div class="individual-results">
          <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞—Ö</h2>
          <div class="respondents-list">
            <div
              class="respondent-card"
              *ngFor="let r of respondents; let i = index">
              <div class="respondent-header">
                <div class="respondent-info">
                  <span class="respondent-number">#{{ i + 1 }}</span>
                  <span class="respondent-email">{{ r.email }}</span>
                  <span class="respondent-age">{{ r.age }} —Ä–æ–∫—ñ–≤</span>
                </div>
                <span class="respondent-timestamp">{{ r.timestamp }}</span>
              </div>
              <div class="respondent-scores">
                <div class="score-item">
                  <span class="score-label">–°–∞–º–æ–ø–æ—á—É—Ç—Ç—è</span>
                  <div class="score-bar-container">
                    <div
                      class="score-bar wellbeing"
                      [style.width.%]="(r.san.wellbeing / 7) * 100"></div>
                  </div>
                  <span
                    class="score-value"
                    [class]="getSanScaleClass(r.san.wellbeing)"
                    >{{ r.san.wellbeing }}</span
                  >
                </div>
                <div class="score-item">
                  <span class="score-label">–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</span>
                  <div class="score-bar-container">
                    <div
                      class="score-bar activity"
                      [style.width.%]="(r.san.activity / 7) * 100"></div>
                  </div>
                  <span
                    class="score-value"
                    [class]="getSanScaleClass(r.san.activity)"
                    >{{ r.san.activity }}</span
                  >
                </div>
                <div class="score-item">
                  <span class="score-label">–ù–∞—Å—Ç—Ä—ñ–π</span>
                  <div class="score-bar-container">
                    <div
                      class="score-bar mood"
                      [style.width.%]="(r.san.mood / 7) * 100"></div>
                  </div>
                  <span
                    class="score-value"
                    [class]="getSanScaleClass(r.san.mood)"
                    >{{ r.san.mood }}</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- –®—Ç–µ–ø–∞ Tab Content -->
      <div class="tab-content" *ngIf="activeTab === 'shtepa'">
        <!-- Overall –®—Ç–µ–ø–∞ Statistics -->
        <div class="overall-stats shtepa-stats">
          <h2>–ó–∞–≥–∞–ª—å–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–æ—ó —Ä–µ—Å—É—Ä—Å–Ω–æ—Å—Ç—ñ</h2>
          <div class="shtepa-overall">
            <div class="shtepa-total-card">
              <div class="stat-label">–ó–∞–≥–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å</div>
              <div class="stat-value large" [class]="overallShtepaLevel.class">
                {{ overallShtepaScore }}
              </div>
              <div class="stat-sublabel">–±–∞–ª—ñ–≤ (—Å–µ—Ä–µ–¥–Ω—î)</div>
              <div class="level-badge" [class]="overallShtepaLevel.class">
                {{ overallShtepaLevel.level }}
              </div>
            </div>
            <div class="level-legend">
              <div class="legend-item">
                <span class="legend-color not-diagnosed"></span>
                <span>0‚Äì56: –Ω–µ –¥—ñ–∞–≥–Ω–æ—Å—Ç—É—î—Ç—å—Å—è</span>
              </div>
              <div class="legend-item">
                <span class="legend-color low"></span>
                <span>57‚Äì69: –Ω–∏–∑—å–∫–∏–π —Ä—ñ–≤–µ–Ω—å</span>
              </div>
              <div class="legend-item">
                <span class="legend-color medium"></span>
                <span>70‚Äì92: —Å–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å</span>
              </div>
              <div class="legend-item">
                <span class="legend-color high"></span>
                <span>93‚Äì106: –≤–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å</span>
              </div>
              <div class="legend-item">
                <span class="legend-color doubtful"></span>
                <span>107‚Äì112: —Å—É–º–Ω—ñ–≤–Ω—ñ –¥–∞–Ω—ñ</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Group-Specific –®—Ç–µ–ø–∞ Statistics -->
        <div
          class="overall-stats shtepa-stats group-stats"
          *ngIf="getGroupCount('1') > 0 || getGroupCount('2') > 0">
          <h2>–ü–æ–∫–∞–∑–Ω–∏–∫–∏ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–æ—ó —Ä–µ—Å—É—Ä—Å–Ω–æ—Å—Ç—ñ –∑–∞ –≥—Ä—É–ø–∞–º–∏</h2>
          <div class="group-comparison">
            <!-- Group 1 -->
            <div class="group-section" *ngIf="getGroupCount('1') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 1 (n={{ getGroupCount('1') }})</h3>
              <div class="shtepa-overall">
                <div class="shtepa-total-card">
                  <div class="stat-label">–ó–∞–≥–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å</div>
                  <div
                    class="stat-value large"
                    [class]="getGroupShtepaLevel('1').class">
                    {{ getGroupShtepaScore('1') }}
                  </div>
                  <div class="stat-sublabel">–±–∞–ª—ñ–≤ (—Å–µ—Ä–µ–¥–Ω—î)</div>
                  <div
                    class="level-badge"
                    [class]="getGroupShtepaLevel('1').class">
                    {{ getGroupShtepaLevel('1').level }}
                  </div>
                </div>
              </div>
              <!-- Distribution -->
              <div class="shtepa-distribution">
                <h4>–†–æ–∑–ø–æ–¥—ñ–ª —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏</h4>
                <div class="distribution-bars">
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupShtepaDistribution('1').notDiagnosed.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–ù–µ –¥—ñ–∞–≥–Ω–æ—Å—Ç—É—î—Ç—å—Å—è</span>
                      <span class="level-range">(0‚Äì56 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar not-diagnosed"
                        [style.width.%]="
                          getGroupShtepaDistribution('1').notDiagnosed.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupShtepaDistribution('1').notDiagnosed.percent
                      }}% ({{
                        getGroupShtepaDistribution('1').notDiagnosed.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('1').low.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–ù–∏–∑—å–∫–∏–π</span>
                      <span class="level-range">(57‚Äì69 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar low"
                        [style.width.%]="
                          getGroupShtepaDistribution('1').low.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('1').low.percent }}% ({{
                        getGroupShtepaDistribution('1').low.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('1').medium.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–°–µ—Ä–µ–¥–Ω—ñ–π</span>
                      <span class="level-range">(70‚Äì92 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar medium"
                        [style.width.%]="
                          getGroupShtepaDistribution('1').medium.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('1').medium.percent }}% ({{
                        getGroupShtepaDistribution('1').medium.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('1').high.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–í–∏—Å–æ–∫–∏–π</span>
                      <span class="level-range">(93‚Äì106 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar high"
                        [style.width.%]="
                          getGroupShtepaDistribution('1').high.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('1').high.percent }}% ({{
                        getGroupShtepaDistribution('1').high.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('1').doubtful.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–°—É–º–Ω—ñ–≤–Ω—ñ –¥–∞–Ω—ñ</span>
                      <span class="level-range">(107‚Äì112 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar doubtful"
                        [style.width.%]="
                          getGroupShtepaDistribution('1').doubtful.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('1').doubtful.percent }}%
                      ({{
                        getGroupShtepaDistribution('1').doubtful.count
                      }})</span
                    >
                  </div>
                </div>
              </div>
              <!-- Category Details -->
              <div class="shtepa-categories-detail">
                <h4>–°–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π</h4>
                <div
                  class="category-item"
                  *ngFor="let catDef of shtepaCategories; let idx = index">
                  <span class="category-name">{{ catDef.name }}</span>
                  <div class="category-bar-container">
                    <div
                      class="category-bar"
                      [class]="
                        getShtepaScoreClass(getGroupShtepaCategory('1', idx), 8)
                      "
                      [style.width.%]="
                        (getGroupShtepaCategory('1', idx) / 8) * 100
                      "></div>
                  </div>
                  <span
                    class="category-score"
                    [class]="
                      getShtepaScoreClass(getGroupShtepaCategory('1', idx), 8)
                    ">
                    {{ getGroupShtepaCategory('1', idx) }}/8
                  </span>
                </div>
              </div>
            </div>

            <!-- Group 2 -->
            <div class="group-section" *ngIf="getGroupCount('2') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 2 (n={{ getGroupCount('2') }})</h3>
              <div class="shtepa-overall">
                <div class="shtepa-total-card">
                  <div class="stat-label">–ó–∞–≥–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å</div>
                  <div
                    class="stat-value large"
                    [class]="getGroupShtepaLevel('2').class">
                    {{ getGroupShtepaScore('2') }}
                  </div>
                  <div class="stat-sublabel">–±–∞–ª—ñ–≤ (—Å–µ—Ä–µ–¥–Ω—î)</div>
                  <div
                    class="level-badge"
                    [class]="getGroupShtepaLevel('2').class">
                    {{ getGroupShtepaLevel('2').level }}
                  </div>
                </div>
              </div>
              <!-- Distribution -->
              <div class="shtepa-distribution">
                <h4>–†–æ–∑–ø–æ–¥—ñ–ª —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏</h4>
                <div class="distribution-bars">
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupShtepaDistribution('2').notDiagnosed.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–ù–µ –¥—ñ–∞–≥–Ω–æ—Å—Ç—É—î—Ç—å—Å—è</span>
                      <span class="level-range">(0‚Äì56 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar not-diagnosed"
                        [style.width.%]="
                          getGroupShtepaDistribution('2').notDiagnosed.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupShtepaDistribution('2').notDiagnosed.percent
                      }}% ({{
                        getGroupShtepaDistribution('2').notDiagnosed.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('2').low.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–ù–∏–∑—å–∫–∏–π</span>
                      <span class="level-range">(57‚Äì69 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar low"
                        [style.width.%]="
                          getGroupShtepaDistribution('2').low.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('2').low.percent }}% ({{
                        getGroupShtepaDistribution('2').low.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('2').medium.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–°–µ—Ä–µ–¥–Ω—ñ–π</span>
                      <span class="level-range">(70‚Äì92 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar medium"
                        [style.width.%]="
                          getGroupShtepaDistribution('2').medium.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('2').medium.percent }}% ({{
                        getGroupShtepaDistribution('2').medium.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('2').high.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–í–∏—Å–æ–∫–∏–π</span>
                      <span class="level-range">(93‚Äì106 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar high"
                        [style.width.%]="
                          getGroupShtepaDistribution('2').high.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('2').high.percent }}% ({{
                        getGroupShtepaDistribution('2').high.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupShtepaDistribution('2').doubtful.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–°—É–º–Ω—ñ–≤–Ω—ñ –¥–∞–Ω—ñ</span>
                      <span class="level-range">(107‚Äì112 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar doubtful"
                        [style.width.%]="
                          getGroupShtepaDistribution('2').doubtful.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupShtepaDistribution('2').doubtful.percent }}%
                      ({{
                        getGroupShtepaDistribution('2').doubtful.count
                      }})</span
                    >
                  </div>
                </div>
              </div>
              <!-- Category Details -->
              <div class="shtepa-categories-detail">
                <h4>–°–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π</h4>
                <div
                  class="category-item"
                  *ngFor="let catDef of shtepaCategories; let idx = index">
                  <span class="category-name">{{ catDef.name }}</span>
                  <div class="category-bar-container">
                    <div
                      class="category-bar"
                      [class]="
                        getShtepaScoreClass(getGroupShtepaCategory('2', idx), 8)
                      "
                      [style.width.%]="
                        (getGroupShtepaCategory('2', idx) / 8) * 100
                      "></div>
                  </div>
                  <span
                    class="category-score"
                    [class]="
                      getShtepaScoreClass(getGroupShtepaCategory('2', idx), 8)
                    ">
                    {{ getGroupShtepaCategory('2', idx) }}/8
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Individual –®—Ç–µ–ø–∞ Results -->
        <div class="individual-results">
          <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞—Ö</h2>
          <div class="respondents-list">
            <div
              class="respondent-card shtepa-card"
              *ngFor="let r of respondents; let i = index">
              <div class="respondent-header">
                <div class="respondent-info">
                  <span class="respondent-number">#{{ i + 1 }}</span>
                  <span class="respondent-email">{{ r.email }}</span>
                  <span class="respondent-age">{{ r.age }} —Ä–æ–∫—ñ–≤</span>
                </div>
                <div class="shtepa-total">
                  <span class="total-score" [class]="r.shtepa.totalLevelClass">
                    {{ r.shtepa.totalScore }}
                  </span>
                  <span class="total-label">–±–∞–ª—ñ–≤</span>
                </div>
              </div>
              <div class="shtepa-level-row">
                <span class="level-badge" [class]="r.shtepa.totalLevelClass">
                  {{ r.shtepa.totalLevel }}
                </span>
              </div>
              <div class="shtepa-categories">
                <div
                  class="category-item"
                  *ngFor="let cat of r.shtepa.categories">
                  <span class="category-name">{{ cat.name }}</span>
                  <div class="category-bar-container">
                    <div
                      class="category-bar"
                      [class]="getShtepaScoreClass(cat.score, cat.maxScore)"
                      [style.width.%]="(cat.score / cat.maxScore) * 100"></div>
                  </div>
                  <span
                    class="category-score"
                    [class]="getShtepaScoreClass(cat.score, cat.maxScore)">
                    {{ cat.score }}/{{ cat.maxScore }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Basic Ph Tab Content -->
      <div class="tab-content" *ngIf="activeTab === 'basicph'">
        <!-- Overall Basic Ph Statistics -->
        <div class="overall-stats basicph-stats">
          <h2>–ó–∞–≥–∞–ª—å–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ Basic Ph</h2>
          <div class="basicph-overall">
            <div class="basicph-categories-grid">
              <div
                class="basicph-stat-card"
                *ngFor="let catDef of basicPhCategories">
                <div class="basicph-code">{{ catDef.code }}</div>
                <div class="basicph-name">{{ catDef.name }}</div>
                <div
                  class="basicph-value"
                  [class]="
                    getBasicPhScoreClass(
                      getOverallBasicPhCategory(catDef.code),
                      36
                    )
                  ">
                  {{ getOverallBasicPhCategory(catDef.code) }}
                </div>
                <div class="basicph-max">/ 36</div>
                <div class="basicph-bar">
                  <div
                    class="basicph-bar-fill"
                    [class]="
                      getBasicPhScoreClass(
                        getOverallBasicPhCategory(catDef.code),
                        36
                      )
                    "
                    [style.width.%]="
                      (getOverallBasicPhCategory(catDef.code) / 36) * 100
                    "></div>
                </div>
              </div>
            </div>
            <div class="basicph-total-summary">
              <span class="total-label">–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ (—Å–µ—Ä–µ–¥–Ω—î):</span>
              <span class="total-value">{{ overallBasicPhTotal }}</span>
              <span class="total-max">/ 216</span>
            </div>
          </div>
        </div>

        <!-- Group-Specific Basic Ph Statistics -->
        <div
          class="overall-stats basicph-stats group-stats"
          *ngIf="getGroupCount('1') > 0 || getGroupCount('2') > 0">
          <h2>–ü–æ–∫–∞–∑–Ω–∏–∫–∏ Basic Ph –∑–∞ –≥—Ä—É–ø–∞–º–∏</h2>
          <div class="group-comparison">
            <!-- Group 1 -->
            <div class="group-section" *ngIf="getGroupCount('1') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 1 (n={{ getGroupCount('1') }})</h3>
              <div class="basicph-overall">
                <div class="basicph-categories-grid">
                  <div
                    class="basicph-stat-card"
                    *ngFor="let catDef of basicPhCategories">
                    <div class="basicph-code">{{ catDef.code }}</div>
                    <div class="basicph-name">{{ catDef.name }}</div>
                    <div
                      class="basicph-value"
                      [class]="
                        getBasicPhScoreClass(
                          getGroupBasicPhCategory('1', catDef.code),
                          36
                        )
                      ">
                      {{ getGroupBasicPhCategory('1', catDef.code) }}
                    </div>
                    <div class="basicph-max">/ 36</div>
                    <div class="basicph-bar">
                      <div
                        class="basicph-bar-fill"
                        [class]="
                          getBasicPhScoreClass(
                            getGroupBasicPhCategory('1', catDef.code),
                            36
                          )
                        "
                        [style.width.%]="
                          (getGroupBasicPhCategory('1', catDef.code) / 36) * 100
                        "></div>
                    </div>
                  </div>
                </div>
                <div class="basicph-total-summary">
                  <span class="total-label">–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ (—Å–µ—Ä–µ–¥–Ω—î):</span>
                  <span class="total-value">{{
                    getGroupBasicPhTotal('1')
                  }}</span>
                  <span class="total-max">/ 216</span>
                </div>
              </div>
            </div>

            <!-- Group 2 -->
            <div class="group-section" *ngIf="getGroupCount('2') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 2 (n={{ getGroupCount('2') }})</h3>
              <div class="basicph-overall">
                <div class="basicph-categories-grid">
                  <div
                    class="basicph-stat-card"
                    *ngFor="let catDef of basicPhCategories">
                    <div class="basicph-code">{{ catDef.code }}</div>
                    <div class="basicph-name">{{ catDef.name }}</div>
                    <div
                      class="basicph-value"
                      [class]="
                        getBasicPhScoreClass(
                          getGroupBasicPhCategory('2', catDef.code),
                          36
                        )
                      ">
                      {{ getGroupBasicPhCategory('2', catDef.code) }}
                    </div>
                    <div class="basicph-max">/ 36</div>
                    <div class="basicph-bar">
                      <div
                        class="basicph-bar-fill"
                        [class]="
                          getBasicPhScoreClass(
                            getGroupBasicPhCategory('2', catDef.code),
                            36
                          )
                        "
                        [style.width.%]="
                          (getGroupBasicPhCategory('2', catDef.code) / 36) * 100
                        "></div>
                    </div>
                  </div>
                </div>
                <div class="basicph-total-summary">
                  <span class="total-label">–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ (—Å–µ—Ä–µ–¥–Ω—î):</span>
                  <span class="total-value">{{
                    getGroupBasicPhTotal('2')
                  }}</span>
                  <span class="total-max">/ 216</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Individual Basic Ph Results -->
        <div class="individual-results">
          <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞—Ö</h2>
          <div class="respondents-list">
            <div
              class="respondent-card basicph-card"
              *ngFor="let r of respondents; let i = index">
              <div class="respondent-header">
                <div class="respondent-info">
                  <span class="respondent-number">#{{ i + 1 }}</span>
                  <span class="respondent-email">{{ r.email }}</span>
                  <span class="respondent-age">{{ r.age }} —Ä–æ–∫—ñ–≤</span>
                </div>
                <div class="basicph-total">
                  <span class="total-score">{{ r.basicPh.totalScore }}</span>
                  <span class="total-label">/ 216</span>
                </div>
              </div>
              <div class="basicph-categories-row">
                <div
                  class="basicph-category-item"
                  *ngFor="let cat of r.basicPh.categories">
                  <div class="cat-header">
                    <span class="cat-code">{{ cat.code }}</span>
                    <span
                      class="cat-score"
                      [class]="getBasicPhScoreClass(cat.score, cat.maxScore)">
                      {{ cat.score }}
                    </span>
                  </div>
                  <div class="cat-name">{{ cat.name }}</div>
                  <div class="cat-bar-container">
                    <div
                      class="cat-bar"
                      [class]="getBasicPhScoreClass(cat.score, cat.maxScore)"
                      [style.width.%]="(cat.score / cat.maxScore) * 100"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Personal Resource Tab Content -->
      <div class="tab-content" *ngIf="activeTab === 'personalresource'">
        <!-- Overall Personal Resource Statistics -->
        <div class="overall-stats pr-stats">
          <h2>
            –ó–∞–≥–∞–ª—å–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –æ—Å–æ–±–∏—Å—Ç—ñ—Å–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ (–û. –°–∞–≤—á–µ–Ω–∫–æ, –°. –°—É–∫–∞—á)
          </h2>
          <div class="pr-overall">
            <div class="pr-categories-grid">
              <!-- –î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å -->
              <div class="pr-stat-card sufficiency">
                <div class="pr-category-name">–î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å</div>
                <div class="pr-score-row">
                  <span
                    class="pr-value"
                    [class]="
                      overallPersonalResourceSufficiency < 13
                        ? 'low'
                        : overallPersonalResourceSufficiency <= 21
                        ? 'medium'
                        : 'high'
                    ">
                    {{ overallPersonalResourceSufficiency }}
                  </span>
                  <span class="pr-max">/ 30</span>
                </div>
                <div class="pr-bar">
                  <div
                    class="pr-bar-fill"
                    [class]="
                      overallPersonalResourceSufficiency < 13
                        ? 'low'
                        : overallPersonalResourceSufficiency <= 21
                        ? 'medium'
                        : 'high'
                    "
                    [style.width.%]="
                      (overallPersonalResourceSufficiency / 30) * 100
                    "></div>
                </div>
                <div class="pr-legend-mini">
                  &lt;13: –Ω–∏–∑—å–∫–∏–π ¬∑ 13-21: —Å–µ—Ä–µ–¥–Ω—ñ–π ¬∑ &gt;21: –≤–∏—Å–æ–∫–∏–π
                </div>
              </div>

              <!-- –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –ø–æ–¥–æ–ª–∞–Ω–Ω—è -->
              <div class="pr-stat-card coping">
                <div class="pr-category-name">–°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –ø–æ–¥–æ–ª–∞–Ω–Ω—è</div>
                <div class="pr-score-row">
                  <span
                    class="pr-value"
                    [class]="
                      overallPersonalResourceCoping < 13
                        ? 'low'
                        : overallPersonalResourceCoping <= 18
                        ? 'medium'
                        : 'high'
                    ">
                    {{ overallPersonalResourceCoping }}
                  </span>
                  <span class="pr-max">/ 20</span>
                </div>
                <div class="pr-bar">
                  <div
                    class="pr-bar-fill"
                    [class]="
                      overallPersonalResourceCoping < 13
                        ? 'low'
                        : overallPersonalResourceCoping <= 18
                        ? 'medium'
                        : 'high'
                    "
                    [style.width.%]="
                      (overallPersonalResourceCoping / 20) * 100
                    "></div>
                </div>
                <div class="pr-legend-mini">
                  &lt;13: –Ω–∏–∑—å–∫–∏–π ¬∑ 13-18: —Å–µ—Ä–µ–¥–Ω—ñ–π ¬∑ &gt;18: –≤–∏—Å–æ–∫–∏–π
                </div>
              </div>

              <!-- –ï–º–æ—Ü—ñ–π–Ω–∞ —Å–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å -->
              <div class="pr-stat-card exhaustion">
                <div class="pr-category-name">–ï–º–æ—Ü—ñ–π–Ω–∞ —Å–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å</div>
                <div class="pr-score-row">
                  <span
                    class="pr-value"
                    [class]="
                      overallPersonalResourceExhaustion < 8
                        ? 'high'
                        : overallPersonalResourceExhaustion <= 12
                        ? 'medium'
                        : 'low'
                    ">
                    {{ overallPersonalResourceExhaustion }}
                  </span>
                  <span class="pr-max">/ 15</span>
                </div>
                <div class="pr-bar">
                  <div
                    class="pr-bar-fill exhaustion-bar"
                    [class]="
                      overallPersonalResourceExhaustion < 8
                        ? 'high'
                        : overallPersonalResourceExhaustion <= 12
                        ? 'medium'
                        : 'low'
                    "
                    [style.width.%]="
                      (overallPersonalResourceExhaustion / 15) * 100
                    "></div>
                </div>
                <div class="pr-legend-mini">
                  &lt;8: –Ω–∏–∑—å–∫–∏–π ‚úì ¬∑ 8-12: —Å–µ—Ä–µ–¥–Ω—ñ–π ¬∑ &gt;12: –≤–∏—Å–æ–∫–∏–π ‚úó
                </div>
              </div>
            </div>

            <!-- Total -->
            <div class="pr-total-card">
              <div class="pr-formula">
                –ó–∞–≥–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å = –î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å + –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó ‚àí –°–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å
              </div>
              <div class="pr-total-row">
                <span
                  class="pr-total-value"
                  [class]="overallPersonalResourceLevel.class">
                  {{ overallPersonalResourceTotal }}
                </span>
                <span
                  class="level-badge"
                  [class]="overallPersonalResourceLevel.class">
                  {{ overallPersonalResourceLevel.level }}
                </span>
              </div>
              <div class="pr-legend-mini">
                &lt;15: –Ω–∏–∑—å–∫–∏–π ¬∑ 15-30: —Å–µ—Ä–µ–¥–Ω—ñ–π ¬∑ &gt;30: –≤–∏—Å–æ–∫–∏–π
              </div>
            </div>
          </div>
        </div>

        <!-- Group-Specific Personal Resource Statistics -->
        <div
          class="overall-stats pr-stats group-stats"
          *ngIf="getGroupCount('1') > 0 || getGroupCount('2') > 0">
          <h2>–ü–æ–∫–∞–∑–Ω–∏–∫–∏ –æ—Å–æ–±–∏—Å—Ç—ñ—Å–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑–∞ –≥—Ä—É–ø–∞–º–∏</h2>
          <div class="group-comparison">
            <!-- Group 1 -->
            <div class="group-section" *ngIf="getGroupCount('1') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 1 (n={{ getGroupCount('1') }})</h3>
              <div class="pr-overall">
                <div class="pr-categories-grid">
                  <div class="pr-stat-card sufficiency">
                    <div class="pr-category-name">–î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å</div>
                    <div class="pr-score-row">
                      <span
                        class="pr-value"
                        [class]="
                          getGroupPersonalResourceSufficiency('1') < 13
                            ? 'low'
                            : getGroupPersonalResourceSufficiency('1') <= 21
                            ? 'medium'
                            : 'high'
                        ">
                        {{ getGroupPersonalResourceSufficiency('1') }}
                      </span>
                      <span class="pr-max">/ 30</span>
                    </div>
                    <div class="pr-bar">
                      <div
                        class="pr-bar-fill"
                        [class]="
                          getGroupPersonalResourceSufficiency('1') < 13
                            ? 'low'
                            : getGroupPersonalResourceSufficiency('1') <= 21
                            ? 'medium'
                            : 'high'
                        "
                        [style.width.%]="
                          (getGroupPersonalResourceSufficiency('1') / 30) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="pr-stat-card coping">
                    <div class="pr-category-name">–°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –ø–æ–¥–æ–ª–∞–Ω–Ω—è</div>
                    <div class="pr-score-row">
                      <span
                        class="pr-value"
                        [class]="
                          getGroupPersonalResourceCoping('1') < 13
                            ? 'low'
                            : getGroupPersonalResourceCoping('1') <= 18
                            ? 'medium'
                            : 'high'
                        ">
                        {{ getGroupPersonalResourceCoping('1') }}
                      </span>
                      <span class="pr-max">/ 20</span>
                    </div>
                    <div class="pr-bar">
                      <div
                        class="pr-bar-fill"
                        [class]="
                          getGroupPersonalResourceCoping('1') < 13
                            ? 'low'
                            : getGroupPersonalResourceCoping('1') <= 18
                            ? 'medium'
                            : 'high'
                        "
                        [style.width.%]="
                          (getGroupPersonalResourceCoping('1') / 20) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="pr-stat-card exhaustion">
                    <div class="pr-category-name">–ï–º–æ—Ü—ñ–π–Ω–∞ —Å–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å</div>
                    <div class="pr-score-row">
                      <span
                        class="pr-value"
                        [class]="
                          getGroupPersonalResourceExhaustion('1') < 8
                            ? 'high'
                            : getGroupPersonalResourceExhaustion('1') <= 12
                            ? 'medium'
                            : 'low'
                        ">
                        {{ getGroupPersonalResourceExhaustion('1') }}
                      </span>
                      <span class="pr-max">/ 15</span>
                    </div>
                    <div class="pr-bar">
                      <div
                        class="pr-bar-fill exhaustion-bar"
                        [class]="
                          getGroupPersonalResourceExhaustion('1') < 8
                            ? 'high'
                            : getGroupPersonalResourceExhaustion('1') <= 12
                            ? 'medium'
                            : 'low'
                        "
                        [style.width.%]="
                          (getGroupPersonalResourceExhaustion('1') / 15) * 100
                        "></div>
                    </div>
                  </div>
                </div>
                <div class="pr-total-card">
                  <div class="pr-formula">
                    –ó–∞–≥–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å = –î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å + –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó ‚àí –°–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å
                  </div>
                  <div class="pr-total-row">
                    <span
                      class="pr-total-value"
                      [class]="getGroupPersonalResourceLevel('1').class">
                      {{ getGroupPersonalResourceTotal('1') }}
                    </span>
                    <span
                      class="level-badge"
                      [class]="getGroupPersonalResourceLevel('1').class">
                      {{ getGroupPersonalResourceLevel('1').level }}
                    </span>
                  </div>
                </div>
              </div>
              <!-- Distribution -->
              <div class="shtepa-distribution">
                <h4>–†–æ–∑–ø–æ–¥—ñ–ª —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏</h4>
                <div class="distribution-bars">
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupPersonalResourceDistribution('1').low.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–ù–∏–∑—å–∫–∏–π</span>
                      <span class="level-range">(0‚Äì14 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar low"
                        [style.width.%]="
                          getGroupPersonalResourceDistribution('1').low.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupPersonalResourceDistribution('1').low.percent
                      }}% ({{
                        getGroupPersonalResourceDistribution('1').low.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupPersonalResourceDistribution('1').medium.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–°–µ—Ä–µ–¥–Ω—ñ–π</span>
                      <span class="level-range">(15‚Äì30 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar medium"
                        [style.width.%]="
                          getGroupPersonalResourceDistribution('1').medium
                            .percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupPersonalResourceDistribution('1').medium
                          .percent
                      }}% ({{
                        getGroupPersonalResourceDistribution('1').medium.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupPersonalResourceDistribution('1').high.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–í–∏—Å–æ–∫–∏–π</span>
                      <span class="level-range">(31+ –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar high"
                        [style.width.%]="
                          getGroupPersonalResourceDistribution('1').high.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupPersonalResourceDistribution('1').high.percent
                      }}% ({{
                        getGroupPersonalResourceDistribution('1').high.count
                      }})</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- Group 2 -->
            <div class="group-section" *ngIf="getGroupCount('2') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 2 (n={{ getGroupCount('2') }})</h3>
              <div class="pr-overall">
                <div class="pr-categories-grid">
                  <div class="pr-stat-card sufficiency">
                    <div class="pr-category-name">–î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å</div>
                    <div class="pr-score-row">
                      <span
                        class="pr-value"
                        [class]="
                          getGroupPersonalResourceSufficiency('2') < 13
                            ? 'low'
                            : getGroupPersonalResourceSufficiency('2') <= 21
                            ? 'medium'
                            : 'high'
                        ">
                        {{ getGroupPersonalResourceSufficiency('2') }}
                      </span>
                      <span class="pr-max">/ 30</span>
                    </div>
                    <div class="pr-bar">
                      <div
                        class="pr-bar-fill"
                        [class]="
                          getGroupPersonalResourceSufficiency('2') < 13
                            ? 'low'
                            : getGroupPersonalResourceSufficiency('2') <= 21
                            ? 'medium'
                            : 'high'
                        "
                        [style.width.%]="
                          (getGroupPersonalResourceSufficiency('2') / 30) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="pr-stat-card coping">
                    <div class="pr-category-name">–°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –ø–æ–¥–æ–ª–∞–Ω–Ω—è</div>
                    <div class="pr-score-row">
                      <span
                        class="pr-value"
                        [class]="
                          getGroupPersonalResourceCoping('2') < 13
                            ? 'low'
                            : getGroupPersonalResourceCoping('2') <= 18
                            ? 'medium'
                            : 'high'
                        ">
                        {{ getGroupPersonalResourceCoping('2') }}
                      </span>
                      <span class="pr-max">/ 20</span>
                    </div>
                    <div class="pr-bar">
                      <div
                        class="pr-bar-fill"
                        [class]="
                          getGroupPersonalResourceCoping('2') < 13
                            ? 'low'
                            : getGroupPersonalResourceCoping('2') <= 18
                            ? 'medium'
                            : 'high'
                        "
                        [style.width.%]="
                          (getGroupPersonalResourceCoping('2') / 20) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="pr-stat-card exhaustion">
                    <div class="pr-category-name">–ï–º–æ—Ü—ñ–π–Ω–∞ —Å–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å</div>
                    <div class="pr-score-row">
                      <span
                        class="pr-value"
                        [class]="
                          getGroupPersonalResourceExhaustion('2') < 8
                            ? 'high'
                            : getGroupPersonalResourceExhaustion('2') <= 12
                            ? 'medium'
                            : 'low'
                        ">
                        {{ getGroupPersonalResourceExhaustion('2') }}
                      </span>
                      <span class="pr-max">/ 15</span>
                    </div>
                    <div class="pr-bar">
                      <div
                        class="pr-bar-fill exhaustion-bar"
                        [class]="
                          getGroupPersonalResourceExhaustion('2') < 8
                            ? 'high'
                            : getGroupPersonalResourceExhaustion('2') <= 12
                            ? 'medium'
                            : 'low'
                        "
                        [style.width.%]="
                          (getGroupPersonalResourceExhaustion('2') / 15) * 100
                        "></div>
                    </div>
                  </div>
                </div>
                <div class="pr-total-card">
                  <div class="pr-formula">
                    –ó–∞–≥–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å = –î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å + –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó ‚àí –°–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å
                  </div>
                  <div class="pr-total-row">
                    <span
                      class="pr-total-value"
                      [class]="getGroupPersonalResourceLevel('2').class">
                      {{ getGroupPersonalResourceTotal('2') }}
                    </span>
                    <span
                      class="level-badge"
                      [class]="getGroupPersonalResourceLevel('2').class">
                      {{ getGroupPersonalResourceLevel('2').level }}
                    </span>
                  </div>
                </div>
              </div>
              <!-- Distribution -->
              <div class="shtepa-distribution">
                <h4>–†–æ–∑–ø–æ–¥—ñ–ª —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏</h4>
                <div class="distribution-bars">
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupPersonalResourceDistribution('2').low.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–ù–∏–∑—å–∫–∏–π</span>
                      <span class="level-range">(0‚Äì14 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar low"
                        [style.width.%]="
                          getGroupPersonalResourceDistribution('2').low.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupPersonalResourceDistribution('2').low.percent
                      }}% ({{
                        getGroupPersonalResourceDistribution('2').low.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupPersonalResourceDistribution('2').medium.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–°–µ—Ä–µ–¥–Ω—ñ–π</span>
                      <span class="level-range">(15‚Äì30 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar medium"
                        [style.width.%]="
                          getGroupPersonalResourceDistribution('2').medium
                            .percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupPersonalResourceDistribution('2').medium
                          .percent
                      }}% ({{
                        getGroupPersonalResourceDistribution('2').medium.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="
                      getGroupPersonalResourceDistribution('2').high.count > 0
                    ">
                    <div class="distribution-label">
                      <span class="level-name">–í–∏—Å–æ–∫–∏–π</span>
                      <span class="level-range">(31+ –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar high"
                        [style.width.%]="
                          getGroupPersonalResourceDistribution('2').high.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{
                        getGroupPersonalResourceDistribution('2').high.percent
                      }}% ({{
                        getGroupPersonalResourceDistribution('2').high.count
                      }})</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Individual Personal Resource Results -->
        <div class="individual-results">
          <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞—Ö</h2>
          <div class="respondents-list">
            <div
              class="respondent-card pr-card"
              *ngFor="let r of respondents; let i = index">
              <div class="respondent-header">
                <div class="respondent-info">
                  <span class="respondent-number">#{{ i + 1 }}</span>
                  <span class="respondent-email">{{ r.email }}</span>
                  <span class="respondent-age">{{ r.age }} —Ä–æ–∫—ñ–≤</span>
                </div>
                <div class="pr-total-header">
                  <span
                    class="total-score"
                    [class]="r.personalResource.totalLevelClass">
                    {{ r.personalResource.totalScore }}
                  </span>
                  <span
                    class="level-badge small"
                    [class]="r.personalResource.totalLevelClass">
                    {{ r.personalResource.totalLevel }}
                  </span>
                </div>
              </div>
              <div class="pr-categories-row">
                <!-- –î–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å -->
                <div class="pr-category-item">
                  <div class="pr-cat-header">
                    <span class="pr-cat-name">{{
                      r.personalResource.sufficiency.name
                    }}</span>
                    <span
                      class="pr-cat-score"
                      [class]="r.personalResource.sufficiency.levelClass">
                      {{ r.personalResource.sufficiency.score }}
                    </span>
                  </div>
                  <div class="pr-cat-bar-container">
                    <div
                      class="pr-cat-bar"
                      [class]="r.personalResource.sufficiency.levelClass"
                      [style.width.%]="
                        (r.personalResource.sufficiency.score /
                          r.personalResource.sufficiency.maxScore) *
                        100
                      "></div>
                  </div>
                  <span
                    class="pr-cat-level"
                    [class]="r.personalResource.sufficiency.levelClass">
                    {{ r.personalResource.sufficiency.level }}
                  </span>
                </div>

                <!-- –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –ø–æ–¥–æ–ª–∞–Ω–Ω—è -->
                <div class="pr-category-item">
                  <div class="pr-cat-header">
                    <span class="pr-cat-name">{{
                      r.personalResource.copingStrategies.name
                    }}</span>
                    <span
                      class="pr-cat-score"
                      [class]="r.personalResource.copingStrategies.levelClass">
                      {{ r.personalResource.copingStrategies.score }}
                    </span>
                  </div>
                  <div class="pr-cat-bar-container">
                    <div
                      class="pr-cat-bar"
                      [class]="r.personalResource.copingStrategies.levelClass"
                      [style.width.%]="
                        (r.personalResource.copingStrategies.score /
                          r.personalResource.copingStrategies.maxScore) *
                        100
                      "></div>
                  </div>
                  <span
                    class="pr-cat-level"
                    [class]="r.personalResource.copingStrategies.levelClass">
                    {{ r.personalResource.copingStrategies.level }}
                  </span>
                </div>

                <!-- –ï–º–æ—Ü—ñ–π–Ω–∞ —Å–ø—É—Å—Ç–æ—à–µ–Ω—ñ—Å—Ç—å -->
                <div class="pr-category-item exhaustion-item">
                  <div class="pr-cat-header">
                    <span class="pr-cat-name">{{
                      r.personalResource.emotionalExhaustion.name
                    }}</span>
                    <span
                      class="pr-cat-score"
                      [class]="
                        r.personalResource.emotionalExhaustion.levelClass
                      ">
                      {{ r.personalResource.emotionalExhaustion.score }}
                    </span>
                  </div>
                  <div class="pr-cat-bar-container">
                    <div
                      class="pr-cat-bar exhaustion-bar"
                      [class]="
                        r.personalResource.emotionalExhaustion.levelClass
                      "
                      [style.width.%]="
                        (r.personalResource.emotionalExhaustion.score /
                          r.personalResource.emotionalExhaustion.maxScore) *
                        100
                      "></div>
                  </div>
                  <span
                    class="pr-cat-level"
                    [class]="r.personalResource.emotionalExhaustion.levelClass">
                    {{ r.personalResource.emotionalExhaustion.level }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Ryff Tab Content -->
      <div class="tab-content" *ngIf="activeTab === 'ryff'">
        <!-- Overall Ryff Statistics -->
        <div class="overall-stats ryff-stats">
          <h2>–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á—á—è (Ryff)</h2>
          <div class="ryff-overall">
            <!-- Categories Grid -->
            <div class="ryff-categories-grid">
              <!-- –í—ñ–¥–Ω–æ—Å–∏–Ω–∏ -->
              <div class="ryff-stat-card">
                <div class="ryff-category-name">–í—ñ–¥–Ω–æ—Å–∏–Ω–∏</div>
                <div class="ryff-score-row">
                  <span
                    class="ryff-value"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffRelationships,
                        ryffCategories.relationships.lowThreshold,
                        ryffCategories.relationships.highThreshold
                      ).class
                    ">
                    {{ overallRyffRelationships }}
                  </span>
                  <span class="ryff-max">/ 84</span>
                </div>
                <div class="ryff-bar">
                  <div
                    class="ryff-bar-fill"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffRelationships,
                        ryffCategories.relationships.lowThreshold,
                        ryffCategories.relationships.highThreshold
                      ).class
                    "
                    [style.width.%]="
                      (overallRyffRelationships / 84) * 100
                    "></div>
                </div>
                <div class="ryff-legend-mini">
                  &lt;53: –Ω–∏–∑ ¬∑ 53-74: —Å–µ—Ä ¬∑ &gt;74: –≤–∏—Å
                </div>
              </div>

              <!-- –ê–≤—Ç–æ–Ω–æ–º—ñ—è -->
              <div class="ryff-stat-card">
                <div class="ryff-category-name">–ê–≤—Ç–æ–Ω–æ–º—ñ—è</div>
                <div class="ryff-score-row">
                  <span
                    class="ryff-value"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffAutonomy,
                        ryffCategories.autonomy.lowThreshold,
                        ryffCategories.autonomy.highThreshold
                      ).class
                    ">
                    {{ overallRyffAutonomy }}
                  </span>
                  <span class="ryff-max">/ 84</span>
                </div>
                <div class="ryff-bar">
                  <div
                    class="ryff-bar-fill"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffAutonomy,
                        ryffCategories.autonomy.lowThreshold,
                        ryffCategories.autonomy.highThreshold
                      ).class
                    "
                    [style.width.%]="(overallRyffAutonomy / 84) * 100"></div>
                </div>
                <div class="ryff-legend-mini">
                  &lt;48: –Ω–∏–∑ ¬∑ 48-62: —Å–µ—Ä ¬∑ &gt;62: –≤–∏—Å
                </div>
              </div>

              <!-- –°–µ—Ä–µ–¥–æ–≤–∏—â–µ -->
              <div class="ryff-stat-card">
                <div class="ryff-category-name">–°–µ—Ä–µ–¥–æ–≤–∏—â–µ</div>
                <div class="ryff-score-row">
                  <span
                    class="ryff-value"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffEnvironment,
                        ryffCategories.environment.lowThreshold,
                        ryffCategories.environment.highThreshold
                      ).class
                    ">
                    {{ overallRyffEnvironment }}
                  </span>
                  <span class="ryff-max">/ 84</span>
                </div>
                <div class="ryff-bar">
                  <div
                    class="ryff-bar-fill"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffEnvironment,
                        ryffCategories.environment.lowThreshold,
                        ryffCategories.environment.highThreshold
                      ).class
                    "
                    [style.width.%]="(overallRyffEnvironment / 84) * 100"></div>
                </div>
                <div class="ryff-legend-mini">
                  &lt;51: –Ω–∏–∑ ¬∑ 51-71: —Å–µ—Ä ¬∑ &gt;71: –≤–∏—Å
                </div>
              </div>

              <!-- –ó—Ä–æ—Å—Ç–∞–Ω–Ω—è -->
              <div class="ryff-stat-card">
                <div class="ryff-category-name">–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è</div>
                <div class="ryff-score-row">
                  <span
                    class="ryff-value"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffGrowth,
                        ryffCategories.growth.lowThreshold,
                        ryffCategories.growth.highThreshold
                      ).class
                    ">
                    {{ overallRyffGrowth }}
                  </span>
                  <span class="ryff-max">/ 84</span>
                </div>
                <div class="ryff-bar">
                  <div
                    class="ryff-bar-fill"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffGrowth,
                        ryffCategories.growth.lowThreshold,
                        ryffCategories.growth.highThreshold
                      ).class
                    "
                    [style.width.%]="(overallRyffGrowth / 84) * 100"></div>
                </div>
                <div class="ryff-legend-mini">
                  &lt;53: –Ω–∏–∑ ¬∑ 53-71: —Å–µ—Ä ¬∑ &gt;71: –≤–∏—Å
                </div>
              </div>

              <!-- –¶—ñ–ª—ñ -->
              <div class="ryff-stat-card">
                <div class="ryff-category-name">–¶—ñ–ª—ñ</div>
                <div class="ryff-score-row">
                  <span
                    class="ryff-value"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffPurpose,
                        ryffCategories.purpose.lowThreshold,
                        ryffCategories.purpose.highThreshold
                      ).class
                    ">
                    {{ overallRyffPurpose }}
                  </span>
                  <span class="ryff-max">/ 84</span>
                </div>
                <div class="ryff-bar">
                  <div
                    class="ryff-bar-fill"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffPurpose,
                        ryffCategories.purpose.lowThreshold,
                        ryffCategories.purpose.highThreshold
                      ).class
                    "
                    [style.width.%]="(overallRyffPurpose / 84) * 100"></div>
                </div>
                <div class="ryff-legend-mini">
                  &lt;54: –Ω–∏–∑ ¬∑ 54-75: —Å–µ—Ä ¬∑ &gt;75: –≤–∏—Å
                </div>
              </div>

              <!-- –°–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è -->
              <div class="ryff-stat-card">
                <div class="ryff-category-name">–°–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è</div>
                <div class="ryff-score-row">
                  <span
                    class="ryff-value"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffSelfAcceptance,
                        ryffCategories.selfAcceptance.lowThreshold,
                        ryffCategories.selfAcceptance.highThreshold
                      ).class
                    ">
                    {{ overallRyffSelfAcceptance }}
                  </span>
                  <span class="ryff-max">/ 84</span>
                </div>
                <div class="ryff-bar">
                  <div
                    class="ryff-bar-fill"
                    [class]="
                      getRyffCategoryLevel(
                        overallRyffSelfAcceptance,
                        ryffCategories.selfAcceptance.lowThreshold,
                        ryffCategories.selfAcceptance.highThreshold
                      ).class
                    "
                    [style.width.%]="
                      (overallRyffSelfAcceptance / 84) * 100
                    "></div>
                </div>
                <div class="ryff-legend-mini">
                  &lt;49: –Ω–∏–∑ ¬∑ 49-71: —Å–µ—Ä ¬∑ &gt;71: –≤–∏—Å
                </div>
              </div>
            </div>

            <!-- Total -->
            <div class="ryff-total-card">
              <div class="ryff-total-label">–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª</div>
              <div class="ryff-total-row">
                <span class="ryff-total-value" [class]="overallRyffLevel.class">
                  {{ overallRyffTotal }}
                </span>
                <span class="ryff-total-max">/ 504</span>
                <span class="level-badge" [class]="overallRyffLevel.class">
                  {{ overallRyffLevel.level }}
                </span>
              </div>
              <div class="ryff-legend-mini">
                &lt;315: –Ω–∏–∑—å–∫–∏–π ¬∑ 315-413: —Å–µ—Ä–µ–¥–Ω—ñ–π ¬∑ &gt;413: –≤–∏—Å–æ–∫–∏–π
              </div>
            </div>
          </div>
        </div>

        <!-- Group-Specific Ryff Statistics -->
        <div
          class="overall-stats ryff-stats group-stats"
          *ngIf="getGroupCount('1') > 0 || getGroupCount('2') > 0">
          <h2>–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á—á—è (Ryff) –∑–∞ –≥—Ä—É–ø–∞–º–∏</h2>
          <div class="group-comparison">
            <!-- Group 1 -->
            <div class="group-section" *ngIf="getGroupCount('1') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 1 (n={{ getGroupCount('1') }})</h3>
              <div class="ryff-overall">
                <div class="ryff-categories-grid">
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–í—ñ–¥–Ω–æ—Å–∏–Ω–∏</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffRelationships('1'),
                            ryffCategories.relationships.lowThreshold,
                            ryffCategories.relationships.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffRelationships('1') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffRelationships('1'),
                            ryffCategories.relationships.lowThreshold,
                            ryffCategories.relationships.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffRelationships('1') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–ê–≤—Ç–æ–Ω–æ–º—ñ—è</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffAutonomy('1'),
                            ryffCategories.autonomy.lowThreshold,
                            ryffCategories.autonomy.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffAutonomy('1') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffAutonomy('1'),
                            ryffCategories.autonomy.lowThreshold,
                            ryffCategories.autonomy.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffAutonomy('1') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–°–µ—Ä–µ–¥–æ–≤–∏—â–µ</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffEnvironment('1'),
                            ryffCategories.environment.lowThreshold,
                            ryffCategories.environment.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffEnvironment('1') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffEnvironment('1'),
                            ryffCategories.environment.lowThreshold,
                            ryffCategories.environment.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffEnvironment('1') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffGrowth('1'),
                            ryffCategories.growth.lowThreshold,
                            ryffCategories.growth.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffGrowth('1') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffGrowth('1'),
                            ryffCategories.growth.lowThreshold,
                            ryffCategories.growth.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffGrowth('1') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–¶—ñ–ª—ñ</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffPurpose('1'),
                            ryffCategories.purpose.lowThreshold,
                            ryffCategories.purpose.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffPurpose('1') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffPurpose('1'),
                            ryffCategories.purpose.lowThreshold,
                            ryffCategories.purpose.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffPurpose('1') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–°–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffSelfAcceptance('1'),
                            ryffCategories.selfAcceptance.lowThreshold,
                            ryffCategories.selfAcceptance.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffSelfAcceptance('1') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffSelfAcceptance('1'),
                            ryffCategories.selfAcceptance.lowThreshold,
                            ryffCategories.selfAcceptance.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffSelfAcceptance('1') / 84) * 100
                        "></div>
                    </div>
                  </div>
                </div>
                <div class="ryff-total-card">
                  <div class="ryff-total-label">–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª</div>
                  <div class="ryff-total-row">
                    <span
                      class="ryff-total-value"
                      [class]="getGroupRyffLevel('1').class">
                      {{ getGroupRyffTotal('1') }}
                    </span>
                    <span class="ryff-total-max">/ 504</span>
                    <span
                      class="level-badge"
                      [class]="getGroupRyffLevel('1').class">
                      {{ getGroupRyffLevel('1').level }}
                    </span>
                  </div>
                </div>
              </div>
              <!-- Distribution -->
              <div class="shtepa-distribution">
                <h4>–†–æ–∑–ø–æ–¥—ñ–ª —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏</h4>
                <div class="distribution-bars">
                  <div
                    class="distribution-item"
                    *ngIf="getGroupRyffDistribution('1').low.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–ù–∏–∑—å–∫–∏–π</span>
                      <span class="level-range">(&lt;314 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar low"
                        [style.width.%]="
                          getGroupRyffDistribution('1').low.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupRyffDistribution('1').low.percent }}% ({{
                        getGroupRyffDistribution('1').low.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupRyffDistribution('1').medium.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–°–µ—Ä–µ–¥–Ω—ñ–π</span>
                      <span class="level-range">(315‚Äì413 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar medium"
                        [style.width.%]="
                          getGroupRyffDistribution('1').medium.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupRyffDistribution('1').medium.percent }}% ({{
                        getGroupRyffDistribution('1').medium.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupRyffDistribution('1').high.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–í–∏—Å–æ–∫–∏–π</span>
                      <span class="level-range">(‚â•414 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar high"
                        [style.width.%]="
                          getGroupRyffDistribution('1').high.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupRyffDistribution('1').high.percent }}% ({{
                        getGroupRyffDistribution('1').high.count
                      }})</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- Group 2 -->
            <div class="group-section" *ngIf="getGroupCount('2') > 0">
              <h3 class="group-title">–ì—Ä—É–ø–∞ 2 (n={{ getGroupCount('2') }})</h3>
              <div class="ryff-overall">
                <div class="ryff-categories-grid">
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–í—ñ–¥–Ω–æ—Å–∏–Ω–∏</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffRelationships('2'),
                            ryffCategories.relationships.lowThreshold,
                            ryffCategories.relationships.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffRelationships('2') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffRelationships('2'),
                            ryffCategories.relationships.lowThreshold,
                            ryffCategories.relationships.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffRelationships('2') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–ê–≤—Ç–æ–Ω–æ–º—ñ—è</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffAutonomy('2'),
                            ryffCategories.autonomy.lowThreshold,
                            ryffCategories.autonomy.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffAutonomy('2') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffAutonomy('2'),
                            ryffCategories.autonomy.lowThreshold,
                            ryffCategories.autonomy.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffAutonomy('2') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–°–µ—Ä–µ–¥–æ–≤–∏—â–µ</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffEnvironment('2'),
                            ryffCategories.environment.lowThreshold,
                            ryffCategories.environment.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffEnvironment('2') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffEnvironment('2'),
                            ryffCategories.environment.lowThreshold,
                            ryffCategories.environment.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffEnvironment('2') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffGrowth('2'),
                            ryffCategories.growth.lowThreshold,
                            ryffCategories.growth.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffGrowth('2') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffGrowth('2'),
                            ryffCategories.growth.lowThreshold,
                            ryffCategories.growth.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffGrowth('2') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–¶—ñ–ª—ñ</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffPurpose('2'),
                            ryffCategories.purpose.lowThreshold,
                            ryffCategories.purpose.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffPurpose('2') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffPurpose('2'),
                            ryffCategories.purpose.lowThreshold,
                            ryffCategories.purpose.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffPurpose('2') / 84) * 100
                        "></div>
                    </div>
                  </div>
                  <div class="ryff-stat-card">
                    <div class="ryff-category-name">–°–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è</div>
                    <div class="ryff-score-row">
                      <span
                        class="ryff-value"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffSelfAcceptance('2'),
                            ryffCategories.selfAcceptance.lowThreshold,
                            ryffCategories.selfAcceptance.highThreshold
                          ).class
                        ">
                        {{ getGroupRyffSelfAcceptance('2') }}
                      </span>
                      <span class="ryff-max">/ 84</span>
                    </div>
                    <div class="ryff-bar">
                      <div
                        class="ryff-bar-fill"
                        [class]="
                          getRyffCategoryLevel(
                            getGroupRyffSelfAcceptance('2'),
                            ryffCategories.selfAcceptance.lowThreshold,
                            ryffCategories.selfAcceptance.highThreshold
                          ).class
                        "
                        [style.width.%]="
                          (getGroupRyffSelfAcceptance('2') / 84) * 100
                        "></div>
                    </div>
                  </div>
                </div>
                <div class="ryff-total-card">
                  <div class="ryff-total-label">–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª</div>
                  <div class="ryff-total-row">
                    <span
                      class="ryff-total-value"
                      [class]="getGroupRyffLevel('2').class">
                      {{ getGroupRyffTotal('2') }}
                    </span>
                    <span class="ryff-total-max">/ 504</span>
                    <span
                      class="level-badge"
                      [class]="getGroupRyffLevel('2').class">
                      {{ getGroupRyffLevel('2').level }}
                    </span>
                  </div>
                </div>
              </div>
              <!-- Distribution -->
              <div class="shtepa-distribution">
                <h4>–†–æ–∑–ø–æ–¥—ñ–ª —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ñ–≤ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏</h4>
                <div class="distribution-bars">
                  <div
                    class="distribution-item"
                    *ngIf="getGroupRyffDistribution('2').low.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–ù–∏–∑—å–∫–∏–π</span>
                      <span class="level-range">(&lt;314 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar low"
                        [style.width.%]="
                          getGroupRyffDistribution('2').low.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupRyffDistribution('2').low.percent }}% ({{
                        getGroupRyffDistribution('2').low.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupRyffDistribution('2').medium.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–°–µ—Ä–µ–¥–Ω—ñ–π</span>
                      <span class="level-range">(315‚Äì413 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar medium"
                        [style.width.%]="
                          getGroupRyffDistribution('2').medium.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupRyffDistribution('2').medium.percent }}% ({{
                        getGroupRyffDistribution('2').medium.count
                      }})</span
                    >
                  </div>
                  <div
                    class="distribution-item"
                    *ngIf="getGroupRyffDistribution('2').high.count > 0">
                    <div class="distribution-label">
                      <span class="level-name">–í–∏—Å–æ–∫–∏–π</span>
                      <span class="level-range">(‚â•414 –±–∞–ª—ñ–≤)</span>
                    </div>
                    <div class="distribution-bar-container">
                      <div
                        class="distribution-bar high"
                        [style.width.%]="
                          getGroupRyffDistribution('2').high.percent
                        "></div>
                    </div>
                    <span class="distribution-percent"
                      >{{ getGroupRyffDistribution('2').high.percent }}% ({{
                        getGroupRyffDistribution('2').high.count
                      }})</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Individual Ryff Results -->
        <div class="individual-results">
          <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞—Ö</h2>
          <div class="respondents-list">
            <div
              class="respondent-card ryff-card"
              *ngFor="let r of respondents; let i = index">
              <div class="respondent-header">
                <div class="respondent-info">
                  <span class="respondent-number">#{{ i + 1 }}</span>
                  <span class="respondent-email">{{ r.email }}</span>
                  <span class="respondent-age">{{ r.age }} —Ä–æ–∫—ñ–≤</span>
                </div>
                <div class="ryff-total-header">
                  <span class="total-score" [class]="r.ryff.totalLevelClass">
                    {{ r.ryff.totalScore }}
                  </span>
                  <span class="total-max">/ 504</span>
                  <span
                    class="level-badge small"
                    [class]="r.ryff.totalLevelClass">
                    {{ r.ryff.totalLevel }}
                  </span>
                </div>
              </div>
              <div class="ryff-categories-row">
                <!-- –í—ñ–¥–Ω–æ—Å–∏–Ω–∏ -->
                <div
                  class="ryff-category-item clickable"
                  (click)="openRyffDetail(r, 'relationships')"
                  title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π">
                  <div class="ryff-cat-header">
                    <span class="ryff-cat-name">–í—ñ–¥–Ω–æ—Å–∏–Ω–∏</span>
                    <span
                      class="ryff-cat-score"
                      [class]="r.ryff.relationships.levelClass">
                      {{ r.ryff.relationships.score }}
                    </span>
                  </div>
                  <div class="ryff-cat-bar-container">
                    <div
                      class="ryff-cat-bar"
                      [class]="r.ryff.relationships.levelClass"
                      [style.width.%]="
                        (r.ryff.relationships.score / 84) * 100
                      "></div>
                  </div>
                  <span
                    class="ryff-cat-level"
                    [class]="r.ryff.relationships.levelClass">
                    {{ r.ryff.relationships.level }}
                  </span>
                  <span class="click-hint">üîç</span>
                </div>

                <!-- –ê–≤—Ç–æ–Ω–æ–º—ñ—è -->
                <div
                  class="ryff-category-item clickable"
                  (click)="openRyffDetail(r, 'autonomy')"
                  title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π">
                  <div class="ryff-cat-header">
                    <span class="ryff-cat-name">–ê–≤—Ç–æ–Ω–æ–º—ñ—è</span>
                    <span
                      class="ryff-cat-score"
                      [class]="r.ryff.autonomy.levelClass">
                      {{ r.ryff.autonomy.score }}
                    </span>
                  </div>
                  <div class="ryff-cat-bar-container">
                    <div
                      class="ryff-cat-bar"
                      [class]="r.ryff.autonomy.levelClass"
                      [style.width.%]="
                        (r.ryff.autonomy.score / 84) * 100
                      "></div>
                  </div>
                  <span
                    class="ryff-cat-level"
                    [class]="r.ryff.autonomy.levelClass">
                    {{ r.ryff.autonomy.level }}
                  </span>
                  <span class="click-hint">üîç</span>
                </div>

                <!-- –°–µ—Ä–µ–¥–æ–≤–∏—â–µ -->
                <div
                  class="ryff-category-item clickable"
                  (click)="openRyffDetail(r, 'environment')"
                  title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π">
                  <div class="ryff-cat-header">
                    <span class="ryff-cat-name">–°–µ—Ä–µ–¥–æ–≤–∏—â–µ</span>
                    <span
                      class="ryff-cat-score"
                      [class]="r.ryff.environment.levelClass">
                      {{ r.ryff.environment.score }}
                    </span>
                  </div>
                  <div class="ryff-cat-bar-container">
                    <div
                      class="ryff-cat-bar"
                      [class]="r.ryff.environment.levelClass"
                      [style.width.%]="
                        (r.ryff.environment.score / 84) * 100
                      "></div>
                  </div>
                  <span
                    class="ryff-cat-level"
                    [class]="r.ryff.environment.levelClass">
                    {{ r.ryff.environment.level }}
                  </span>
                  <span class="click-hint">üîç</span>
                </div>

                <!-- –ó—Ä–æ—Å—Ç–∞–Ω–Ω—è -->
                <div
                  class="ryff-category-item clickable"
                  (click)="openRyffDetail(r, 'growth')"
                  title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π">
                  <div class="ryff-cat-header">
                    <span class="ryff-cat-name">–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è</span>
                    <span
                      class="ryff-cat-score"
                      [class]="r.ryff.growth.levelClass">
                      {{ r.ryff.growth.score }}
                    </span>
                  </div>
                  <div class="ryff-cat-bar-container">
                    <div
                      class="ryff-cat-bar"
                      [class]="r.ryff.growth.levelClass"
                      [style.width.%]="(r.ryff.growth.score / 84) * 100"></div>
                  </div>
                  <span
                    class="ryff-cat-level"
                    [class]="r.ryff.growth.levelClass">
                    {{ r.ryff.growth.level }}
                  </span>
                  <span class="click-hint">üîç</span>
                </div>

                <!-- –¶—ñ–ª—ñ -->
                <div
                  class="ryff-category-item clickable"
                  (click)="openRyffDetail(r, 'purpose')"
                  title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π">
                  <div class="ryff-cat-header">
                    <span class="ryff-cat-name">–¶—ñ–ª—ñ</span>
                    <span
                      class="ryff-cat-score"
                      [class]="r.ryff.purpose.levelClass">
                      {{ r.ryff.purpose.score }}
                    </span>
                  </div>
                  <div class="ryff-cat-bar-container">
                    <div
                      class="ryff-cat-bar"
                      [class]="r.ryff.purpose.levelClass"
                      [style.width.%]="(r.ryff.purpose.score / 84) * 100"></div>
                  </div>
                  <span
                    class="ryff-cat-level"
                    [class]="r.ryff.purpose.levelClass">
                    {{ r.ryff.purpose.level }}
                  </span>
                  <span class="click-hint">üîç</span>
                </div>

                <!-- –°–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è -->
                <div
                  class="ryff-category-item clickable"
                  (click)="openRyffDetail(r, 'selfAcceptance')"
                  title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π">
                  <div class="ryff-cat-header">
                    <span class="ryff-cat-name">–°–∞–º–æ—Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è</span>
                    <span
                      class="ryff-cat-score"
                      [class]="r.ryff.selfAcceptance.levelClass">
                      {{ r.ryff.selfAcceptance.score }}
                    </span>
                  </div>
                  <div class="ryff-cat-bar-container">
                    <div
                      class="ryff-cat-bar"
                      [class]="r.ryff.selfAcceptance.levelClass"
                      [style.width.%]="
                        (r.ryff.selfAcceptance.score / 84) * 100
                      "></div>
                  </div>
                  <span
                    class="ryff-cat-level"
                    [class]="r.ryff.selfAcceptance.levelClass">
                    {{ r.ryff.selfAcceptance.level }}
                  </span>
                  <span class="click-hint">üîç</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Ryff Detail Modal -->
<div
  class="modal-overlay"
  *ngIf="showRyffDetailModal"
  (click)="closeRyffDetail()">
  <div
    class="modal-content ryff-detail-modal"
    (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ ryffDetailCategory }}</h3>
      <button class="modal-close" (click)="closeRyffDetail()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="respondent-info-modal" *ngIf="ryffDetailRespondent">
        <span class="email">{{ ryffDetailRespondent.email }}</span>
      </div>

      <div class="questions-table">
        <div class="table-header">
          <span class="col-num">‚Ññ</span>
          <span class="col-raw">–í—ñ–¥–ø–æ–≤—ñ–¥—å</span>
          <span class="col-reversed">–û–±–µ—Ä–Ω–µ–Ω–∞?</span>
          <span class="col-final">–ë–∞–ª</span>
        </div>
        <div class="table-row" *ngFor="let q of ryffDetailQuestions">
          <span class="col-num">Q{{ q.num }}</span>
          <span class="col-raw">{{ q.rawAnswer }}</span>
          <span class="col-reversed" [class.yes]="q.isReversed">
            {{ q.isReversed ? '–¢–∞–∫' : '–ù—ñ' }}
          </span>
          <span class="col-final" [class.reversed]="q.isReversed">
            {{ q.finalAnswer }}
          </span>
        </div>
      </div>

      <div class="modal-total">
        <span class="total-label">–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª:</span>
        <span class="total-value">{{ ryffDetailTotal }}</span>
        <span class="total-max">/ 84</span>
      </div>
    </div>
  </div>
</div>
